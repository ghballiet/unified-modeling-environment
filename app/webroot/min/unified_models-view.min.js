$(document).ready(function(){function grabExogenousData(){var url=$("#data-url").val();$.post(url,{},function(data){eval(data);console.log("Values: ",values);console.log("Facts: ",empirical_data);console.log("Simulation data loaded.");drawCharts(values)})}function createRows(a,b){var c=b.entity_name;for(var d in b){if(d=="id"||d=="entity_name")continue;var e=$("<tr />"),f=$("<span />").addClass("name").html(d),g=$("<td />").addClass("row").html(a),h=$("<td />").addClass("name").append(f),i=$("<td />").addClass("value").html(b[d]);e.append(g).append(h).append(i);$("#simulation-data tbody").append(e)}}function drawCharts(a){var b={};for(var c in a[0]){var d=new google.visualization.DataTable;d.addColumn("number","Time");d.addColumn("number","Simulated");d.addColumn("number","Observed");b[c]=d}for(var c in a)for(var e in a[c]){var f=[];f.push(parseInt(c));f.push(a[c][e]);f.push(empirical_data[c][e]);b[e].addRows([f])}var g=$("#right").width();for(var c in b){var h={width:g,height:100,title:c,fontSize:10,fontName:"Helvetica, Arial",curveType:"function",legend:{position:"bottom"}},i=c.toLowerCase().replace(/\./g,"-").replace(/_/g,"-"),j=$("<div />").attr("id","chart-"+i).addClass("google-chart");$("#google-chart").append(j);var k=new google.visualization.LineChart(document.getElementById("chart-"+i));k.draw(b[c],h);var l=$("<input >").attr({type:"checkbox",name:c,id:"chk-"+i,checked:!0,"data-show-id":"chart-"+i}).addClass("chk-data-select"),m=$("<label />").attr("for","chk-"+i);m.html(c);var n=$("<div />").addClass("data-select").append(l).append(m);$("#data-selection").append(n)}$("input.chk-data-select").live("change",function(){var a=$(this).attr("data-show-id");$(this).is(":checked")?$("#"+a).show("fast"):$("#"+a).hide("fast")})}function genericProcessArgs(){$("#GenericProcessNumArguments").change(function(){var a=parseInt($(this).val())+1,b=0;$("div.input.hidden").hide();for(b=1;b<=a;b++)$("#arg_"+b).show()})}function concreteProcessArgs(){var a=$("#ConcreteProcessGenericProcessId").val();loadConcreteProcessArgs(a);$("#ConcreteProcessGenericProcessId").change(function(){loadConcreteProcessArgs($(this).val())})}function loadConcreteProcessArgs(a){var b=concrete_process_argument_list,c=0;$("#ConcreteProcessArguments").html("");for(var d in b[a]){c++;var e=b[a][d],f=$("<div />").addClass("input select"),g=parseInt(d)+1,h=$("<label />").html("Argument "+g),i=$("<select />").attr("name","data[ConcreteProcess][argument-"+d+"]");for(var j in e){var k=$("<option />").val(j).html(e[j]);i.append(k)}f.append(h).append(i);$("#ConcreteProcessArguments").append(f)}$("#ConcreteProcessNumArguments").val(c)}$("a.deleteModel").live("click",function(a){a.preventDefault();var b=$(this).attr("data-delete-url"),c=confirm("Are you sure you want to delete this model? This CANNOT be undone.");c&&(window.location=b)});$("a.expand").toggle(function(){var a=$("#"+$(this).attr("data-expand-id")),b=$("#"+a.attr("data-expand-id")),c=b.find("div.generic-attribute");a.html(c.clone());a.find("a.btnDelete").remove();a.fadeIn("fast");$(this).html("&#x25b2;")},function(){var a=$("#"+$(this).attr("data-expand-id"));a.hide();$(this).html("&#x25bc;")});$('input[type="text"], textarea').live("keypress",function(a){if($(this).attr("id")=="ConcreteEquationRightHandSide"||$(this).attr("id")=="GenericEquationRightHandSide"||$(this).attr("id")=="ExogenousValueValue"||$(this).attr("id")=="EmpiricalObservationValue")return!0;if(a.keyCode==32){a.preventDefault();var b=$(this).val()+"_";$(this).val(b)}else{var c=String.fromCharCode(a.keyCode);c.match(/\W/g)!=null&&c!="."&&a.preventDefault()}});grabExogenousData();genericProcessArgs();concreteProcessArgs()});